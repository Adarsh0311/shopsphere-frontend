<div class="order-review-container">
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-white">
      <h5 class="mb-0">Review Order</h5>
    </div>
    <div class="card-body">
      <!-- Shipping Information Review -->
      <div class="review-section mb-4">
        <div class="d-flex justify-content-between mb-2">
          <h6 class="fw-bold mb-0">Shipping Information</h6>
          <button type="button" class="btn btn-link btn-sm p-0" (click)="onBack()">Edit</button>
        </div>
        <div class="review-content" *ngIf="shippingAddress">
          <!-- <p class="mb-1">{{ shippingAddress.fullName }}</p> -->
          <p class="mb-1">{{ shippingAddress.street }}</p>
          <!-- <p class="mb-1" *ngIf="shippingAddress.addressLine2">{{ shippingAddress.addressLine2 }}</p> -->
          <p class="mb-1">{{ shippingAddress.city }}, {{ shippingAddress.state }} {{ shippingAddress.postalCode }}</p>
          <p class="mb-1">{{ shippingAddress.country }}</p>
          <p class="mb-0">{{ shippingAddress.user }}</p>
        </div>
      </div>
      
      <!-- Payment Method Review -->
      <div class="review-section mb-4">
        <div class="d-flex justify-content-between mb-2">
          <h6 class="fw-bold mb-0">Payment Method</h6>
          <button type="button" class="btn btn-link btn-sm p-0" (click)="onBack()">Edit</button>
        </div>
        <div class="review-content">
          <p class="mb-0">{{ paymentMethod }}</p>
        </div>
      </div>
      
      <!-- Order Items Review -->
      <div class="review-section mb-4">
        <h6 class="fw-bold mb-3">Order Items</h6>
        <div class="table-responsive">
          <table class="table table-borderless mb-0">
            <thead class="table-light">
              <tr>
                <th>Product</th>
                <th class="text-center">Quantity</th>
                <th class="text-end">Price</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of cartData.items">
                <td>{{ item.productName }}</td>
                <td class="text-center">{{ item.quantity }}</td>
                <td class="text-end">${{ item.itemTotal.toFixed(2) }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- Order Summary -->
      <div class="review-section mb-4">
        <h6 class="fw-bold mb-3">Order Summary</h6>
        <div class="d-flex justify-content-between mb-2">
          <span>Subtotal</span>
          <span>${{ subtotal.toFixed(2) }}</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span>Shipping</span>
          <span *ngIf="shippingCost === 0" class="text-success">Free</span>
          <span *ngIf="shippingCost > 0">${{ shippingCost.toFixed(2) }}</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span>Tax (8%)</span>
          <span>${{ tax.toFixed(2) }}</span>
        </div>
        <hr>
        <div class="d-flex justify-content-between">
          <span class="fw-bold">Total</span>
          <span class="fw-bold">${{ total.toFixed(2) }}</span>
        </div>
      </div>
      
      <!-- Order Notes -->
      <div class="review-section">
        <h6 class="fw-bold mb-2">Order Notes (Optional)</h6>
        <form [formGroup]="notesForm">
          <textarea 
            class="form-control" 
            rows="3" 
            placeholder="Add any special instructions or notes for your order"
            formControlName="orderNotes"
          ></textarea>
        </form>
      </div>
    </div>
  </div>

  <!-- Error Alert -->
  <div *ngIf="orderError" class="alert alert-danger mb-4" role="alert">
    {{ orderError }}
    <button type="button" class="btn-close" aria-label="Close" (click)="dismissError()"></button>
  </div>

  
  <!-- Place Order Button -->
  <div class="d-grid">
    <button 
      type="button" 
      class="btn btn-primary btn-lg" 
      (click)="placeOrder()"
      [disabled]="isSubmitting"
    >
      <span *ngIf="!isSubmitting">Place Order</span>

      <span *ngIf="isSubmitting">
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        Processing...
      </span>
    </button>
  </div>
</div>